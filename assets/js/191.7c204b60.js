(window.webpackJsonp=window.webpackJsonp||[]).push([[191],{560:function(e,a,t){"use strict";t.r(a);var r=t(42),s=Object(r.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"controller"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#controller"}},[e._v("#")]),e._v(" Controller")]),e._v(" "),t("h2",{attrs:{id:"redirect-to"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redirect-to"}},[e._v("#")]),e._v(" redirect_to")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('redirect_to controller: "merchants",action: "show", notice: "餐厅信息更新成功！"\nredirect_to :back, notice: "恭喜您，删除成功！"\n')])])]),t("h2",{attrs:{id:"获得数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获得数据"}},[e._v("#")]),e._v(" 获得数据")]),e._v(" "),t("ul",[t("li",[e._v("从关链表中取出数据"),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("def show\n    @group = Group.find(params[:id])\n    @posts = @group.posts\nend\n")])])])]),e._v(" "),t("li",[e._v("如果不存在就新建一条数据"),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("resume = Resume.where(user_id: current_user.id).first_or_create!\n")])])])])]),e._v(" "),t("h2",{attrs:{id:"写入数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#写入数据库"}},[e._v("#")]),e._v(" 写入数据库")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("build(app)")]),e._v(" = "),t("code",[e._v("new(app)")]),e._v(" # 别名？")])]),e._v(" "),t("h2",{attrs:{id:"更新某属性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更新某属性"}},[e._v("#")]),e._v(" 更新某属性")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v(" user.update_attribute :admin, true\n")])])]),t("h2",{attrs:{id:"权限控制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#权限控制"}},[e._v("#")]),e._v(" 权限控制")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"http://liuzxc.github.io/articles/rails-app-study-04/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Rails 应用开发笔记（四）"),t("OutboundLink")],1)])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('  def require_admin\n    if not admin?\n      flash[:error] = "您没有权限操作！"\n      redirect_to home_path\n    end\n  end\n')])])]),t("blockquote",[t("p",[e._v("before_action 和 before_filter 的区别 before_action 和 before_filter 其实是一个东西，只是在 Rails4.0 之前使用的是 before_filter，之后改成了 before_action，相当于功能一样，只是名字不同而已。")])]),e._v(" "),t("h2",{attrs:{id:"strong-params"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#strong-params"}},[e._v("#")]),e._v(" Strong Params")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("params.require(:person).permit(:name, :age)\n")])])]),t("h2",{attrs:{id:"render-partial"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#render-partial"}},[e._v("#")]),e._v(" render partial")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("#多用于，接收到 ajax 回传后，再次渲染局部模板，可带参数 如：`@comment`\n$('#comments ul.comments').append(\"<%= escape_javascript render(:partial => 'comments/single', :locals => { :c => @comment }) %>\");\n")])])]),t("h2",{attrs:{id:"create-与-create"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-与-create"}},[e._v("#")]),e._v(" create 与 create!")]),e._v(" "),t("p",[e._v("其中create和create!就等於new完就save和save!，\n有無驚嘆號的差別在於validate資料驗證不正確的動作，無驚嘆號版本會回傳布林值(true或false)，有驚嘆號版本則是驗證錯誤會丟出例外。")]),e._v(" "),t("h2",{attrs:{id:"refresh"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#refresh"}},[e._v("#")]),e._v(" refresh")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("# 原来页面\nsession[:return_to] ||= request.referer\n\n# update页面\nredirect_to session.delete(:return_to)\n")])])])])}),[],!1,null,null,null);a.default=s.exports}}]);